{
  "schema_version": "1.1.0",
  "metadata": {
    "name": "Inventory Report Demo",
    "description": "Reads a CSV, summarises it, derives insights, and renders an HTML report. (Golden fixture copy)"
  },
  "nodes": [
    {
      "id": "read_csv",
      "type": "tool",
      "name": "Load CSV",
      "tool_name": "csv_reader",
      "tool_args": {
        "file_path": "examples/items.csv",
        "delimiter": ","
      },
      "input_schema": {"file_path": "str", "delimiter": "str"},
      "output_schema": {"headers": "list[str]", "rows": "list[dict]", "rows_json": "str"}
    },
    {
      "id": "summarise",
      "type": "llm",
      "name": "Summarise Dataset",
      "dependencies": ["read_csv"],
      "model": "gpt-4o",
      "prompt": "You are a data assistant. Summarise the following CSV rows in under 150 tokens.\n\n{{ read_csv.rows_json }}",
      "llm_config": {"provider": "openai", "model": "gpt-4o"}
    },
    {
      "id": "insights",
      "type": "llm",
      "name": "Generate Insights",
      "dependencies": ["summarise"],
      "model": "gpt-4o",
      "prompt": "Given this summary, produce 3-5 actionable insights as a JSON list under key 'insights'.\n\n{{ summarise.text }}",
      "llm_config": {"provider": "openai", "model": "gpt-4o"}
    },
    {
      "id": "render_report",
      "type": "tool",
      "name": "Render HTML Report",
      "dependencies": ["read_csv", "summarise", "insights"],
      "tool_name": "jinja_render",
      "tool_args": {
        "template": "<html><head><title>Inventory Report</title></head><body><h1>Dataset Summary</h1><p>{{ summary }}</p><h2>Insights</h2><ul>{% for i in insights %}<li>{{ i }}</li>{% endfor %}</ul></body></html>",
        "context": {
          "summary": "{summarise.text}",
          "insights": "{insights.text}"
        }
      },
      "input_schema": {"template": "str", "context": "dict"},
      "output_schema": {"rendered": "str"}
    }
  ]
} 